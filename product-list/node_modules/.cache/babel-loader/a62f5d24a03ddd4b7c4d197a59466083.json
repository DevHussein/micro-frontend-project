{"ast":null,"code":"import _objectSpread from\"/Users/hussainalsabr/Desktop/My Files/Self Development/typescript-projects/Mastering-TypeScript-Fourth-Edition/ch16/product-list/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _classCallCheck from\"/Users/hussainalsabr/Desktop/My Files/Self Development/typescript-projects/Mastering-TypeScript-Fourth-Edition/ch16/product-list/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/hussainalsabr/Desktop/My Files/Self Development/typescript-projects/Mastering-TypeScript-Fourth-Edition/ch16/product-list/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _assertThisInitialized from\"/Users/hussainalsabr/Desktop/My Files/Self Development/typescript-projects/Mastering-TypeScript-Fourth-Edition/ch16/product-list/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _inherits from\"/Users/hussainalsabr/Desktop/My Files/Self Development/typescript-projects/Mastering-TypeScript-Fourth-Edition/ch16/product-list/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/hussainalsabr/Desktop/My Files/Self Development/typescript-projects/Mastering-TypeScript-Fourth-Edition/ch16/product-list/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import'./App.css';import{CollectionView}from'./CollectionView';import{DetailView}from'./DetailView';import{Collection}from'./Products';import{ajax}from'rxjs/ajax';import{CircularProgress}from\"@material-ui/core\";import*as _ from\"underscore\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var microEventBus=window.microEventBus;;// this class instance will now be part of the App state\n// const collectionInstance = new Collection();\nvar App=/*#__PURE__*/function(_React$Component){_inherits(App,_React$Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this.showDetailView=_this.showDetailView.bind(_assertThisInitialized(_this));_this.handleClose=_this.handleClose.bind(_assertThisInitialized(_this));_this.state={showDetails:false,product:null,collectionInstance:new Collection(),username:\"\"};return _this;}_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.processUserLoginEvent=this.processUserLoginEvent.bind(this);// console.log(`window.broadcastService : ${(window as any).broadcastService}`)\n// console.log(`messageBus : ${broadcastService}`)\nmicroEventBus.on('user-logged-in').subscribe(this.processUserLoginEvent);ajax.getJSON(\"http://127.0.0.1:3000/products\").subscribe(function(data){var collection=new Collection();collection.items=data;_this2.setState({showDetails:false,product:null,collectionInstance:collection});});}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(\"div\",{children:[this.state.collectionInstance.items.length<1?/*#__PURE__*/_jsx(\"div\",{className:\"App-header\",children:/*#__PURE__*/_jsx(CircularProgress,{})}):\"\",/*#__PURE__*/_jsx(CollectionView// {...collectionInstance}\n// replaced with:\n,_objectSpread(_objectSpread({},this.state.collectionInstance),{},{handleItemClicked:this.showDetailView})),/*#__PURE__*/_jsx(DetailView,{open:this.state.showDetails,product:this.state.product,handleClose:this.handleClose,username:this.state.username})]});}},{key:\"showDetailView\",value:function showDetailView(id){console.log(\"App.handleClick() called\");var foundItem=_.find(this.state.collectionInstance.items,function(item){return item.id===id;});if(foundItem){this.setState({showDetails:true,product:foundItem,username:this.state.username});}}},{key:\"handleClose\",value:function handleClose(){console.log(\"App : handleClose()\");this.setState({showDetails:false,product:null});}},{key:\"processUserLoginEvent\",value:function processUserLoginEvent(event){console.log(\"RCT : App.processUserLoginEvent : \".concat(event));if(event){this.setState({username:event});}}}]);return App;}(React.Component);export default App;","map":{"version":3,"names":["React","CollectionView","DetailView","Collection","ajax","CircularProgress","_","jsx","_jsx","jsxs","_jsxs","microEventBus","window","App","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","showDetailView","bind","_assertThisInitialized","handleClose","state","showDetails","product","collectionInstance","username","_createClass","key","value","componentDidMount","_this2","processUserLoginEvent","on","subscribe","getJSON","data","collection","items","setState","render","children","length","className","_objectSpread","handleItemClicked","open","id","console","log","foundItem","find","item","event","concat","Component"],"sources":["/Users/hussainalsabr/Desktop/My Files/Self Development/typescript-projects/Mastering-TypeScript-Fourth-Edition/ch16/product-list/src/App.tsx"],"sourcesContent":["import React from 'react';\nimport './App.css';\nimport { CollectionView } from './CollectionView';\nimport { DetailView } from './DetailView';\nimport { Collection, IProduct } from './Products';\nimport { ajax } from 'rxjs/ajax';\n\nimport { CircularProgress } from \"@material-ui/core\";\nimport * as _ from \"underscore\";\nimport { MicroEventBus } from 'micro-event-bus';\nexport let microEventBus: MicroEventBus = (window as any).microEventBus;\n\nexport interface IAppProps { };\nexport interface IAppState {\n    showDetails: boolean;\n    product: IProduct | null;\n    collectionInstance: Collection;\n    username: string;\n}\n\n// this class instance will now be part of the App state\n// const collectionInstance = new Collection();\n\nclass App extends\n    React.Component<IAppProps, IAppState> {\n\n    constructor(props: IAppProps) {\n        super(props);\n        this.showDetailView =\n            this.showDetailView.bind(this);\n        this.handleClose = this.handleClose.bind(this);\n\n        this.state = {\n            showDetails: false,\n            product: null,\n            collectionInstance: new Collection(),\n            username: \"\"\n        };\n\n\n    }\n\n    componentDidMount() {\n        this.processUserLoginEvent = this.processUserLoginEvent.bind(this);\n\n        // console.log(`window.broadcastService : ${(window as any).broadcastService}`)\n        // console.log(`messageBus : ${broadcastService}`)\n\n        microEventBus.on('user-logged-in').subscribe(\n            this.processUserLoginEvent\n        );\n\n        ajax.getJSON(\"http://127.0.0.1:3000/products\")\n            .subscribe((data) => {\n                let collection = new Collection();\n                collection.items = data as IProduct[];\n                this.setState({\n                    showDetails: false,\n                    product: null,\n                    collectionInstance: collection\n                });\n            });\n    }\n\n    render() {\n        return (\n            <div>\n                { this.state.collectionInstance.items.length < 1 ?\n                    <div className=\"App-header\">\n                        <CircularProgress />\n                    </div>\n                    : \"\"}\n                <CollectionView\n                    // {...collectionInstance}\n                    // replaced with:\n                    {...this.state.collectionInstance}\n                    handleItemClicked={this.showDetailView} >\n                </CollectionView>\n                <DetailView open={this.state.showDetails}\n                    product={this.state.product}\n                    handleClose={this.handleClose}\n                    username={this.state.username}\n                ></DetailView>\n            </div>\n        )\n    }\n    showDetailView(id: number) {\n        console.log(`App.handleClick() called`);\n        let foundItem = _.find(\n            this.state.collectionInstance.items,\n            (item: IProduct) => {\n                return item.id === id\n            });\n\n        if (foundItem) {\n\n            this.setState({\n                showDetails: true,\n                product: foundItem,\n                username: this.state.username\n            });\n        }\n\n    }\n    handleClose() {\n        console.log(`App : handleClose()`);\n        this.setState({\n            showDetails: false,\n            product: null\n        })\n    }\n    processUserLoginEvent(event: string | undefined) {\n        console.log(`RCT : App.processUserLoginEvent : ${event}`);\n\n        if (event) {\n            this.setState({ username: event });\n        }\n    }\n}\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}
{"remainingRequest":"/Users/hussainalsabr/Desktop/My Files/Self Development/typescript-projects/Mastering-TypeScript-Fourth-Edition/ch16/shopping-cart/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/hussainalsabr/Desktop/My Files/Self Development/typescript-projects/Mastering-TypeScript-Fourth-Edition/ch16/shopping-cart/src/App.vue?vue&type=template&id=7ba5bd90","dependencies":[{"path":"/Users/hussainalsabr/Desktop/My Files/Self Development/typescript-projects/Mastering-TypeScript-Fourth-Edition/ch16/shopping-cart/src/App.vue","mtime":1690047611312},{"path":"/Users/hussainalsabr/Desktop/My Files/Self Development/typescript-projects/Mastering-TypeScript-Fourth-Edition/ch16/shopping-cart/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/templateLoader.js","mtime":1690034493082},{"path":"/Users/hussainalsabr/Desktop/My Files/Self Development/typescript-projects/Mastering-TypeScript-Fourth-Edition/ch16/shopping-cart/node_modules/cache-loader/dist/cjs.js","mtime":1690034489199},{"path":"/Users/hussainalsabr/Desktop/My Files/Self Development/typescript-projects/Mastering-TypeScript-Fourth-Edition/ch16/shopping-cart/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js","mtime":1690034493078}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiAgPGRpdiB2LWlmPSJsb2FkaW5nIiBjbGFzcz0ibG9hZGluZyI+CiAgICBMb2FkaW5nLi4uCiAgPC9kaXY+CiAgPGRpdiB2LWlmPSIhbG9hZGluZyIgY2xhc3M9ImxvYWRpbmciPgogICAgPFNob3BwaW5nQ2FydCA6Y29sbGVjdGlvbj0iY2FydEl0ZW1zIiBAb24tdXBkYXRlLWNhcnQ9Im9uVXBkYXRlQ2FydCIgLz4KICA8L2Rpdj4K"},{"version":3,"sources":["/Users/hussainalsabr/Desktop/My Files/Self Development/typescript-projects/Mastering-TypeScript-Fourth-Edition/ch16/shopping-cart/src/App.vue"],"names":[],"mappings":";EACE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACjC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACX,CAAC,CAAC,CAAC,CAAC,CAAC;EACL,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAClC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;EACxE,CAAC,CAAC,CAAC,CAAC,CAAC","file":"/Users/hussainalsabr/Desktop/My Files/Self Development/typescript-projects/Mastering-TypeScript-Fourth-Edition/ch16/shopping-cart/src/App.vue","sourceRoot":"","sourcesContent":["<template>\n  <div v-if=\"loading\" class=\"loading\">\n    Loading...\n  </div>\n  <div v-if=\"!loading\" class=\"loading\">\n    <ShoppingCart :collection=\"cartItems\" @on-update-cart=\"onUpdateCart\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { Vue, Options } from \"vue-class-component\";\nimport { CartCollection, IProduct } from \"./CartItems\";\nimport ShoppingCart from \"./components/ShoppingCart.vue\";\nimport { ajax } from \"rxjs/ajax\";\nimport { MicroEventBus } from \"micro-event-bus\";\nexport let microEventBus: MicroEventBus = (window as any).microEventBus;\n\n// let shoppingCartItems = new CartCollection();\n\ninterface IItemData {\n  username: string;\n  productId: number;\n  amount: string;\n}\n\n@Options({\n  components: {\n    ShoppingCart,\n  },\n  mounted() {\n    console.log(`VUE: App:mounted()`);\n    microEventBus.on(\"add-user-cart-item\").subscribe(this.handleAddItemToCart);\n\n    microEventBus.on(\"user-logged-in\").subscribe(this.handleUserLoggedIn);\n  },\n})\nexport default class App extends Vue {\n  cartItems!: CartCollection;\n  username!: string;\n  loading: boolean = false;\n  data() {\n    // return {\n    //     cartItems: shoppingCartItems\n    // }\n    return {\n      cartItems: [],\n      username: null,\n      loading: true,\n    };\n  }\n  handleUserLoggedIn(event: string) {\n    console.log(`VUE: App.handleUserLoggedIn : ${event}`);\n    this.username = event;\n    this.loading = true;\n    this.fetchData();\n  }\n\n  fetchData() {\n    console.log(`calling ajax with ${this.username}`);\n    ajax\n      .getJSON(\n        `https://n55jrj6nra.execute-api.us-east-1.amazonaws.com/Prod/carts/${this.username}`\n      )\n      .subscribe(\n        (data) => {\n          console.log(`cart loaded from API`);\n          let cartItems = new CartCollection();\n          cartItems.items = <IProduct[]>data;\n          this.cartItems = cartItems;\n          this.loading = false;\n        },\n        (error) => {\n          console.log(`VUE: get /carts/(username) error : ${error}`);\n          this.loading = false;\n        }\n      );\n  }\n\n  handleAddItemToCart(data: IItemData) {\n    console.log(`handleAddItemToCart : item : ${JSON.stringify(data)}`);\n    console.log(`calling GET on /products/${data.productId}`);\n    setTimeout(() => {\n      this.loading = true;\n      ajax\n        .getJSON(\n          `https://n55jrj6nra.execute-api.us-east-1.amazonaws.com/Prod/products/${data.productId}`\n        )\n        .subscribe(\n          (product) => {\n            let productItem = <IProduct>product;\n            productItem.amount = parseInt(data.amount);\n            this.cartItems.items.push(productItem);\n            this.loading = false;\n          },\n          (error) => {\n            console.log(`VUE: products/${data.productId} : error ${error}`);\n          }\n        );\n    }, 200);\n  }\n\n  onUpdateCart() {\n    console.log(`App.onUpdateCart`);\n    let postBody = this.cartItems.getCartItemsPostData();\n    console.log(`postBody : ${JSON.stringify(postBody)}`);\n    this.loading = true;\n    ajax\n      .post(\n        `https://n55jrj6nra.execute-api.us-east-1.amazonaws.com/Prod/carts/${this.username}`,\n        JSON.stringify(postBody)\n      )\n      .subscribe(\n        () => {\n          console.log(`post succeeded`);\n          this.loading = false;\n        },\n        (error) => {\n          console.log(\n            `VUE: post to /cards/{username} failed : error : ${error}`\n          );\n          this.loading = false;\n        }\n      );\n  }\n}\n</script>\n\n<style scoped></style>\n"]}]}